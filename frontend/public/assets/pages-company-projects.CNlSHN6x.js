import{b as t,g as e,n as a,s,d as l,w as o,i as c,o as d,e as i,f as r,h as n,j as u,x as p,t as f,S as m,k as _,F as h,l as j,m as g,p as C,I as k,y as F}from"./index-BJtJjslE.js";import{p as v,_ as P}from"./_plugin-vue_export-helper.CmGny4PI.js";const b=P({name:"ProjectsPage",data:()=>({projects:[],showProjectModal:!1,isEditMode:!1,projectForm:{id:null,name:"",description:"",status:"planning",start_date:"",end_date:""},selectedStatusIndex:0,statusFilterOptions:["å…¨éƒ¨çŠ¶æ€","è§„åˆ’ä¸­","è¿›è¡Œä¸­","å·²å®Œæˆ","å·²æš‚åœ","å·²å–æ¶ˆ"],statusOptions:[{label:"è§„åˆ’ä¸­",value:"planning"},{label:"è¿›è¡Œä¸­",value:"in_progress"},{label:"å·²å®Œæˆ",value:"completed"},{label:"å·²æš‚åœ",value:"suspended"},{label:"å·²å–æ¶ˆ",value:"cancelled"}],filterStatus:"",isLoading:!1}),computed:{filteredProjects(){return this.filterStatus?this.projects.filter(t=>t.status===this.filterStatus):this.projects}},mounted(){this.loadProjects()},methods:{loadProjects(){v.getAll().then(t=>{t.success&&t.data&&(this.projects=t.data)}).catch(e=>{console.error("åŠ è½½é¡¹ç›®åˆ—è¡¨å¤±è´¥:",e),t({title:"åŠ è½½å¤±è´¥",icon:"none"})})},onStatusFilterChange(t){this.selectedStatusIndex=t.detail.value;this.filterStatus={0:"",1:"planning",2:"in_progress",3:"completed",4:"suspended",5:"cancelled"}[this.selectedStatusIndex]},showCreateProjectModal(){const s=e("userInfo");if(!s||!s.id)return t({title:"è¯·å…ˆç™»å½•",icon:"none"}),void a({url:"/pages/login/index"});this.isEditMode=!1,this.projectForm={id:null,name:"",description:"",status:"planning",start_date:"",end_date:""},this.showProjectModal=!0},editProject(t){this.isEditMode=!0,this.projectForm={id:t.id||null,name:t.name,description:t.description||"",status:t.status,start_date:t.start_date||"",end_date:t.end_date||""},this.showProjectModal=!0},deleteProject(e){s({title:"ç¡®è®¤åˆ é™¤",content:`ç¡®å®šè¦åˆ é™¤é¡¹ç›®"${e.name}"å—ï¼Ÿ`,success:a=>{a.confirm&&e.id&&v.delete(e.id).then(e=>{e.success?(t({title:"åˆ é™¤æˆåŠŸ",icon:"success"}),this.loadProjects()):t({title:e.message||"åˆ é™¤å¤±è´¥",icon:"none"})}).catch(e=>{console.error("åˆ é™¤é¡¹ç›®å¤±è´¥:",e),t({title:"åˆ é™¤å¤±è´¥",icon:"none"})})}})},viewProjectDetail(t){a({url:`/pages/projects/detail?id=${t.id}`})},selectStatus(t){this.projectForm.status=t},onStartDateChange(t){this.projectForm.start_date=t.detail.value},onEndDateChange(t){this.projectForm.end_date=t.detail.value},handleModalOverlayClick(){this.closeProjectModal()},closeProjectModal(){this.showProjectModal=!1},submitProjectForm(){if(!this.projectForm.name.trim())return void t({title:"è¯·è¾“å…¥é¡¹ç›®åç§°",icon:"none"});const a=e("userInfo");if(!a||!a.id)return void t({title:"ç”¨æˆ·ä¿¡æ¯å·²å¤±æ•ˆï¼Œè¯·é‡æ–°ç™»å½•",icon:"none"});this.isLoading=!0;const s={name:this.projectForm.name.trim(),description:this.projectForm.description.trim(),status:this.projectForm.status,start_date:this.projectForm.start_date||void 0,end_date:this.projectForm.end_date||void 0};this.isEditMode||(s.created_by=a.id);(this.isEditMode&&this.projectForm.id?v.update(this.projectForm.id,s):v.create(s)).then(e=>{this.isLoading=!1,e.success?(t({title:this.isEditMode?"æ›´æ–°æˆåŠŸ":"åˆ›å»ºæˆåŠŸ",icon:"success"}),this.closeProjectModal(),this.loadProjects()):t({title:e.message||"æ“ä½œå¤±è´¥",icon:"none"})}).catch(e=>{this.isLoading=!1,console.error("æäº¤é¡¹ç›®å¤±è´¥:",e),t({title:"æ“ä½œå¤±è´¥",icon:"none"})})},getStatusLabel:t=>({planning:"è§„åˆ’ä¸­",in_progress:"è¿›è¡Œä¸­",completed:"å·²å®Œæˆ",suspended:"å·²æš‚åœ",cancelled:"å·²å–æ¶ˆ"}[t]||t),getStatusClass:t=>`status-${t}`}},[["render",function(t,e,a,s,v,P){const b=n,M=c,S=p,y=m,x=k,w=F;return d(),l(M,{class:"projects-page"},{default:o(()=>[i(M,{class:"page-header"},{default:o(()=>[i(b,{class:"page-title"},{default:o(()=>[u("é¡¹ç›®ç®¡ç†")]),_:1}),i(M,{class:"header-actions"},{default:o(()=>[i(M,{class:"action-button",onClick:P.showCreateProjectModal},{default:o(()=>[i(b,{class:"action-icon"},{default:o(()=>[u("+")]),_:1}),i(b,{class:"action-text"},{default:o(()=>[u("æ–°å»ºé¡¹ç›®")]),_:1})]),_:1},8,["onClick"])]),_:1})]),_:1}),i(M,{class:"filter-section"},{default:o(()=>[i(M,{class:"filter-item"},{default:o(()=>[i(S,{range:v.statusFilterOptions,value:v.selectedStatusIndex,onChange:P.onStatusFilterChange},{default:o(()=>[i(M,{class:"picker-input"},{default:o(()=>[i(b,null,{default:o(()=>[u(f(v.statusFilterOptions[v.selectedStatusIndex]),1)]),_:1}),i(b,{class:"arrow"},{default:o(()=>[u("â–¼")]),_:1})]),_:1})]),_:1},8,["range","value","onChange"])]),_:1})]),_:1}),i(y,{class:"projects-list","scroll-y":""},{default:o(()=>[(d(!0),_(h,null,j(P.filteredProjects,t=>(d(),l(M,{class:"project-card",key:t.id,onClick:e=>P.viewProjectDetail(t)},{default:o(()=>[i(M,{class:"project-header"},{default:o(()=>[i(M,{class:"project-info"},{default:o(()=>[i(b,{class:"project-name"},{default:o(()=>[u(f(t.name),1)]),_:2},1024),i(b,{class:"project-creator"},{default:o(()=>[u("åˆ›å»ºäººï¼š"+f(t.creator_name||"æœªçŸ¥"),1)]),_:2},1024)]),_:2},1024),i(M,{class:g(["project-status",P.getStatusClass(t.status)])},{default:o(()=>[u(f(P.getStatusLabel(t.status)),1)]),_:2},1032,["class"])]),_:2},1024),i(M,{class:"project-body"},{default:o(()=>[i(b,{class:"project-description"},{default:o(()=>[u(f(t.description||"æš‚æ— æè¿°"),1)]),_:2},1024)]),_:2},1024),i(M,{class:"project-meta"},{default:o(()=>[t.start_date?(d(),l(b,{key:0,class:"meta-item"},{default:o(()=>[u("å¼€å§‹ï¼š"+f(t.start_date),1)]),_:2},1024)):r("",!0),t.end_date?(d(),l(b,{key:1,class:"meta-item"},{default:o(()=>[u("ç»“æŸï¼š"+f(t.end_date),1)]),_:2},1024)):r("",!0)]),_:2},1024),i(M,{class:"project-actions"},{default:o(()=>[i(M,{class:"action-btn edit",onClick:C(e=>P.editProject(t),["stop"])},{default:o(()=>[u("ç¼–è¾‘")]),_:2},1032,["onClick"]),i(M,{class:"action-btn delete",onClick:C(e=>P.deleteProject(t),["stop"])},{default:o(()=>[u("åˆ é™¤")]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1032,["onClick"]))),128)),0===P.filteredProjects.length?(d(),l(M,{key:0,class:"empty-state"},{default:o(()=>[i(b,{class:"empty-icon"},{default:o(()=>[u("ðŸ“")]),_:1}),i(b,{class:"empty-text"},{default:o(()=>[u("æš‚æ— é¡¹ç›®")]),_:1}),i(b,{class:"empty-tip"},{default:o(()=>[u("ç‚¹å‡»å³ä¸Šè§’æŒ‰é’®åˆ›å»ºæ–°é¡¹ç›®")]),_:1})]),_:1})):r("",!0)]),_:1}),v.showProjectModal?(d(),l(M,{key:0,class:"project-modal-overlay",onClick:P.handleModalOverlayClick},{default:o(()=>[i(M,{class:"project-modal-container",onClick:e[2]||(e[2]=C(()=>{},["stop"]))},{default:o(()=>[i(M,{class:"modal-header"},{default:o(()=>[i(b,{class:"modal-title"},{default:o(()=>[u(f(v.isEditMode?"ç¼–è¾‘é¡¹ç›®":"æ–°å»ºé¡¹ç›®"),1)]),_:1}),i(M,{class:"close-btn",onClick:P.closeProjectModal},{default:o(()=>[u("âœ•")]),_:1},8,["onClick"])]),_:1}),i(M,{class:"modal-content"},{default:o(()=>[i(M,{class:"form-group"},{default:o(()=>[i(b,{class:"form-label"},{default:o(()=>[u("é¡¹ç›®åç§°")]),_:1}),i(x,{class:"form-input",type:"text",modelValue:v.projectForm.name,"onUpdate:modelValue":e[0]||(e[0]=t=>v.projectForm.name=t),placeholder:"è¯·è¾“å…¥é¡¹ç›®åç§°"},null,8,["modelValue"])]),_:1}),i(M,{class:"form-group"},{default:o(()=>[i(b,{class:"form-label"},{default:o(()=>[u("é¡¹ç›®æè¿°")]),_:1}),i(w,{class:"form-textarea",modelValue:v.projectForm.description,"onUpdate:modelValue":e[1]||(e[1]=t=>v.projectForm.description=t),placeholder:"è¯·è¾“å…¥é¡¹ç›®æè¿°ï¼ˆå¯é€‰ï¼‰",maxlength:"500"},null,8,["modelValue"])]),_:1}),i(M,{class:"form-group"},{default:o(()=>[i(b,{class:"form-label"},{default:o(()=>[u("é¡¹ç›®çŠ¶æ€")]),_:1}),i(M,{class:"status-selector"},{default:o(()=>[(d(!0),_(h,null,j(v.statusOptions,(t,e)=>(d(),l(M,{class:g(["status-option",{active:v.projectForm.status===t.value}]),key:t.value,onClick:e=>P.selectStatus(t.value)},{default:o(()=>[i(b,{class:"status-text"},{default:o(()=>[u(f(t.label),1)]),_:2},1024)]),_:2},1032,["class","onClick"]))),128))]),_:1})]),_:1}),i(M,{class:"form-group"},{default:o(()=>[i(b,{class:"form-label"},{default:o(()=>[u("å¼€å§‹æ—¥æœŸ")]),_:1}),i(S,{mode:"date",value:v.projectForm.start_date,onChange:P.onStartDateChange},{default:o(()=>[i(M,{class:"picker-input"},{default:o(()=>[i(b,null,{default:o(()=>[u(f(v.projectForm.start_date||"è¯·é€‰æ‹©å¼€å§‹æ—¥æœŸ"),1)]),_:1}),i(b,{class:"arrow"},{default:o(()=>[u("â–¼")]),_:1})]),_:1})]),_:1},8,["value","onChange"])]),_:1}),i(M,{class:"form-group"},{default:o(()=>[i(b,{class:"form-label"},{default:o(()=>[u("ç»“æŸæ—¥æœŸ")]),_:1}),i(S,{mode:"date",value:v.projectForm.end_date,onChange:P.onEndDateChange},{default:o(()=>[i(M,{class:"picker-input"},{default:o(()=>[i(b,null,{default:o(()=>[u(f(v.projectForm.end_date||"è¯·é€‰æ‹©ç»“æŸæ—¥æœŸ"),1)]),_:1}),i(b,{class:"arrow"},{default:o(()=>[u("â–¼")]),_:1})]),_:1})]),_:1},8,["value","onChange"])]),_:1})]),_:1}),i(M,{class:"modal-actions"},{default:o(()=>[i(M,{class:"btn btn-cancel",onClick:P.closeProjectModal},{default:o(()=>[u("å–æ¶ˆ")]),_:1},8,["onClick"]),i(M,{class:"btn btn-submit",onClick:P.submitProjectForm},{default:o(()=>[u("ç¡®å®š")]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1},8,["onClick"])):r("",!0)]),_:1})}],["__scopeId","data-v-1deb78cd"]]);export{b as default};
