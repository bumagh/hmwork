import{s as t,r as e,a,n as s,b as l,c,g as o,d as n,w as i,i as r,o as u,e as d,f,h as _,j as p,t as m,S as g,k as h,F as y,l as C,m as v,p as k,q as T}from"./index-BJtJjslE.js";import{p as U,u as x,t as A,_ as w}from"./_plugin-vue_export-helper.CmGny4PI.js";const M=w({name:"CompanyIndexPage",data:()=>({currentUser:{id:null,username:"",role:""},projectCount:0,userCount:0,taskCount:0,recentActivities:[],showMenu:!1,userColors:["#6FCF97","#F2994A","#BB6BD9","#56CCF2","#EB5757"]}),mounted(){this.loadUserInfo(),this.loadStatistics(),this.loadRecentActivities()},methods:{loadUserInfo(){try{const t=o("userInfo");t?this.currentUser=t:this.redirectToLogin()}catch(t){console.error("åŠ è½½ç”¨æˆ·ä¿¡æ¯å¤±è´¥:",t),this.redirectToLogin()}},redirectToLogin(){l({title:"è¯·å…ˆç™»å½•",icon:"none",duration:2e3}),setTimeout(()=>{c({url:"/pages/login/index"})},2e3)},loadStatistics(){U.getAll().then(t=>{t.success&&t.data&&(this.projectCount=t.data.length)}).catch(t=>{console.error("åŠ è½½é¡¹ç›®ç»Ÿè®¡å¤±è´¥:",t)}),x.getAll().then(t=>{t.success&&t.data&&(this.userCount=t.data.length)}).catch(t=>{console.error("åŠ è½½ç”¨æˆ·ç»Ÿè®¡å¤±è´¥:",t)}),A.getAll().then(t=>{t.success&&t.data&&(this.taskCount=t.data.filter(t=>"in_progress"===t.status).length)}).catch(t=>{console.error("åŠ è½½ä»»åŠ¡ç»Ÿè®¡å¤±è´¥:",t)})},loadRecentActivities(){this.recentActivities=[]},navigateTo(t){s({url:t})},showUserMenu(){this.showMenu=!0},closeUserMenu(){this.showMenu=!1},handleLogout(){t({title:"ç¡®è®¤é€€å‡º",content:"ç¡®å®šè¦é€€å‡ºç™»å½•å—ï¼Ÿ",success:t=>{if(t.confirm)try{e("userInfo"),e("token"),a({url:"/pages/login/index"})}catch(s){console.error("é€€å‡ºç™»å½•å¤±è´¥:",s)}}})},getRoleLabel:t=>({resource_coordinator:"èµ„æºåè°ƒ",tech_manager:"æŠ€æœ¯ç»ç†",consultant:"é¡¾é—®",user:"æ™®é€šç”¨æˆ·"}[t]||t),getUserColor(){return this.currentUser.id?this.userColors[this.currentUser.id%this.userColors.length]:this.userColors[0]},getActivityType:t=>`activity-${t}`,getActivityIcon:t=>({project:"ðŸ“",task:"ðŸ“‹",user:"ðŸ‘¤"}[t]||"ðŸ“Œ"),formatTime(t){if(!t)return"";const e=new Date(t),a=(new Date).getTime()-e.getTime(),s=Math.floor(a/6e4),l=Math.floor(s/60),c=Math.floor(l/24);return c>0?`${c}å¤©å‰`:l>0?`${l}å°æ—¶å‰`:s>0?`${s}åˆ†é’Ÿå‰`:"åˆšåˆš"}}},[["render",function(t,e,a,s,l,c){const o=_,U=r,x=g;return u(),n(U,{class:"company-page"},{default:i(()=>[d(U,{class:"page-header"},{default:i(()=>[d(o,{class:"page-title"},{default:i(()=>[p("å…¬å¸ç®¡ç†")]),_:1}),d(U,{class:"user-info",onClick:c.showUserMenu},{default:i(()=>[d(o,{class:"user-icon"},{default:i(()=>[p("ðŸ‘¤")]),_:1}),d(o,{class:"username"},{default:i(()=>[p(m(l.currentUser.username),1)]),_:1})]),_:1},8,["onClick"])]),_:1}),d(U,{class:"stats-section"},{default:i(()=>[d(U,{class:"stat-card",onClick:e[0]||(e[0]=t=>c.navigateTo("/pages/company/projects"))},{default:i(()=>[d(U,{class:"stat-icon"},{default:i(()=>[p("ðŸ“")]),_:1}),d(U,{class:"stat-content"},{default:i(()=>[d(o,{class:"stat-value"},{default:i(()=>[p(m(l.projectCount),1)]),_:1}),d(o,{class:"stat-label"},{default:i(()=>[p("é¡¹ç›®æ€»æ•°")]),_:1})]),_:1})]),_:1}),d(U,{class:"stat-card",onClick:e[1]||(e[1]=t=>c.navigateTo("/pages/company/users"))},{default:i(()=>[d(U,{class:"stat-icon"},{default:i(()=>[p("ðŸ‘¥")]),_:1}),d(U,{class:"stat-content"},{default:i(()=>[d(o,{class:"stat-value"},{default:i(()=>[p(m(l.userCount),1)]),_:1}),d(o,{class:"stat-label"},{default:i(()=>[p("å›¢é˜Ÿæˆå‘˜")]),_:1})]),_:1})]),_:1}),d(U,{class:"stat-card",onClick:e[2]||(e[2]=t=>c.navigateTo("/pages/company/tasks"))},{default:i(()=>[d(U,{class:"stat-icon"},{default:i(()=>[p("ðŸ“‹")]),_:1}),d(U,{class:"stat-content"},{default:i(()=>[d(o,{class:"stat-value"},{default:i(()=>[p(m(l.taskCount),1)]),_:1}),d(o,{class:"stat-label"},{default:i(()=>[p("è¿›è¡Œä¸­ä»»åŠ¡")]),_:1})]),_:1})]),_:1})]),_:1}),d(U,{class:"quick-actions"},{default:i(()=>[d(o,{class:"section-title"},{default:i(()=>[p("å¿«é€Ÿæ“ä½œ")]),_:1}),d(U,{class:"action-grid"},{default:i(()=>[d(U,{class:"action-item",onClick:e[3]||(e[3]=t=>c.navigateTo("/pages/company/projects"))},{default:i(()=>[d(U,{class:"action-icon-wrapper project"},{default:i(()=>[d(o,{class:"action-icon"},{default:i(()=>[p("ðŸ“")]),_:1})]),_:1}),d(o,{class:"action-text"},{default:i(()=>[p("é¡¹ç›®ç®¡ç†")]),_:1})]),_:1}),d(U,{class:"action-item",onClick:e[4]||(e[4]=t=>c.navigateTo("/pages/company/users"))},{default:i(()=>[d(U,{class:"action-icon-wrapper users"},{default:i(()=>[d(o,{class:"action-icon"},{default:i(()=>[p("ðŸ‘¥")]),_:1})]),_:1}),d(o,{class:"action-text"},{default:i(()=>[p("äººå‘˜ç®¡ç†")]),_:1})]),_:1}),d(U,{class:"action-item",onClick:e[5]||(e[5]=t=>c.navigateTo("/pages/company/tasks"))},{default:i(()=>[d(U,{class:"action-icon-wrapper tasks"},{default:i(()=>[d(o,{class:"action-icon"},{default:i(()=>[p("ðŸ“‹")]),_:1})]),_:1}),d(o,{class:"action-text"},{default:i(()=>[p("ä»»åŠ¡ç®¡ç†")]),_:1})]),_:1}),d(U,{class:"action-item",onClick:e[6]||(e[6]=t=>c.navigateTo("/pages/index/index"))},{default:i(()=>[d(U,{class:"action-icon-wrapper finance"},{default:i(()=>[d(o,{class:"action-icon"},{default:i(()=>[p("ðŸ’°")]),_:1})]),_:1}),d(o,{class:"action-text"},{default:i(()=>[p("è®°è´¦åŠ©æ‰‹")]),_:1})]),_:1})]),_:1})]),_:1}),d(U,{class:"recent-activities"},{default:i(()=>[d(U,{class:"section-header"},{default:i(()=>[d(o,{class:"section-title"},{default:i(()=>[p("æœ€è¿‘åŠ¨æ€")]),_:1})]),_:1}),d(x,{class:"activity-list","scroll-y":""},{default:i(()=>[(u(!0),h(y,null,C(l.recentActivities,t=>(u(),n(U,{class:"activity-item",key:t.id},{default:i(()=>[d(U,{class:v(["activity-icon",c.getActivityType(t.type)])},{default:i(()=>[d(o,null,{default:i(()=>[p(m(c.getActivityIcon(t.type)),1)]),_:2},1024)]),_:2},1032,["class"]),d(U,{class:"activity-content"},{default:i(()=>[d(o,{class:"activity-title"},{default:i(()=>[p(m(t.title),1)]),_:2},1024),d(o,{class:"activity-time"},{default:i(()=>[p(m(c.formatTime(t.time)),1)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128)),0===l.recentActivities.length?(u(),n(U,{key:0,class:"empty-state"},{default:i(()=>[d(o,{class:"empty-icon"},{default:i(()=>[p("ðŸ“­")]),_:1}),d(o,{class:"empty-text"},{default:i(()=>[p("æš‚æ— åŠ¨æ€")]),_:1})]),_:1})):f("",!0)]),_:1})]),_:1}),l.showMenu?(u(),n(U,{key:0,class:"user-menu-overlay",onClick:c.closeUserMenu},{default:i(()=>[d(U,{class:"user-menu-container",onClick:e[7]||(e[7]=k(()=>{},["stop"]))},{default:i(()=>[d(U,{class:"menu-header"},{default:i(()=>[d(U,{class:"menu-avatar",style:T({backgroundColor:c.getUserColor()})},{default:i(()=>[d(o,{class:"avatar-text"},{default:i(()=>[p(m(l.currentUser.username.charAt(0).toUpperCase()),1)]),_:1})]),_:1},8,["style"]),d(U,{class:"menu-user-info"},{default:i(()=>[d(o,{class:"menu-username"},{default:i(()=>[p(m(l.currentUser.username),1)]),_:1}),d(o,{class:"menu-role"},{default:i(()=>[p(m(c.getRoleLabel(l.currentUser.role)),1)]),_:1})]),_:1})]),_:1}),d(U,{class:"menu-actions"},{default:i(()=>[d(U,{class:"menu-item",onClick:c.handleLogout},{default:i(()=>[d(o,{class:"menu-icon"},{default:i(()=>[p("ðŸšª")]),_:1}),d(o,{class:"menu-text"},{default:i(()=>[p("é€€å‡ºç™»å½•")]),_:1})]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1},8,["onClick"])):f("",!0)]),_:1})}],["__scopeId","data-v-8cb219ad"]]);export{M as default};
